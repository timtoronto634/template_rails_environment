templateディレクトリをコピー
cd コピーしたdirectory
docker-compose run --no-deps web bundle ex rails new . --force --database=postgresql

gemfile からtzinfoを削除
必要であれば、Gemfileを丁寧に変える。rails tutorial なら以下を変更
  gem 'jquery-rails', '~> 4.3'
  gem 'sqlite3', '~> 1.3'
  gem 'rails-controller-testing', '~> 1.0'
  gem 'minitest',                 '~> 5.10'
  gem 'minitest-reporters',       '~> 1.1'
  gem 'guard',                    '~> 2.16'
  gem 'guard-minitest',           '~> 2.4'
tzinfo というgemが邪魔なので消す。windows上で動かすために入っているライブラリ


if [ $(cat /proc/version | grep Linux | wc -l) -eq 0 ]; then
  sudo chown -R $USER:$USER .
fi

docker-compose build
databaseファイルを以下のように書き換え（をしない方がいいかも）

```
default: &default
  adapter: postgresql
  encoding: unicode
  host: db
  username: postgres
  password: password
  pool: 5

development:
  <<: *default
  database: myapp_development


test:
  <<: *default
  database: myapp_test
```

docker-compose up -d
docker-compose run web rake db:create

# docker-compose run --no-deps web bundle install



https://docs.docker.com/samples/rails/